import{r as i,j as g,a as t,u as q,$ as _,b as N,m as h,K as x,C as f,S as C,c as S,d as b,F as $,E as k,e as v}from"./main.7b829983.js";function M({equation:r,setEquation:c,inline:s},e){const o=d=>{c(d.target.value)};return s&&e instanceof HTMLInputElement?g("span",{className:"EquationEditor_inputBackground",children:[t("span",{className:"EquationEditor_dollarSign",children:"$"}),t("input",{className:"EquationEditor_inlineEditor",value:r,onChange:o,autoFocus:!0,ref:e}),t("span",{className:"EquationEditor_dollarSign",children:"$"})]}):g("div",{className:"EquationEditor_inputBackground",children:[t("span",{className:"EquationEditor_dollarSign",children:`$$
`}),t("textarea",{className:"EquationEditor_blockEditor",value:r,onChange:o,ref:e}),t("span",{className:"EquationEditor_dollarSign",children:`
$$`})]})}var A=i.exports.forwardRef(M);function H({equation:r,inline:c,nodeKey:s}){const[e]=q(),[o,d]=i.exports.useState(r),[l,E]=i.exports.useState(!1),m=i.exports.useRef(null),p=i.exports.useCallback(a=>{E(!1),e.update(()=>{const n=_(s);N(n)&&(n.setEquation(o),a&&n.selectNext(0,0))})},[e,o,s]);return i.exports.useEffect(()=>{!l&&o!==r&&d(r)},[l,r,o]),i.exports.useEffect(()=>l?h(e.registerCommand(C,a=>{const n=document.activeElement;return m.current!==n&&p(),!1},f),e.registerCommand(x,a=>{const n=document.activeElement;return m.current===n?(p(!0),!0):!1},f)):e.registerUpdateListener(({editorState:a})=>{a.read(()=>{const u=S();return b(u)&&u.has(s)&&u.getNodes().length===1})&&E(!0)}),[e,s,p,l]),t($,{children:l?t(A,{equation:o,setEquation:d,inline:c,ref:m}):t(k,{onError:a=>e._onError(a),fallback:null,children:t(v,{equation:o,inline:c,onDoubleClick:()=>E(!0)})})})}export{H as default};
