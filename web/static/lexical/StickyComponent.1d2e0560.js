import{a2 as P,u as _,r as y,o as z,a3 as D,t as T,a as s,j as E,y as B,z as X,G as $,a4 as Y,I as j,P as H,J as W,$ as h,a5 as k}from"./main.60ca7335.js";import{L as I}from"./LexicalNestedComposer.f9db440f.js";const O={...P,paragraph:"StickyEditorTheme__paragraph"};var A=O;function m(f,c){const d=f.style,u=c.rootElementRect,g=u!==null?u.left:0,l=u!==null?u.top:0;d.top=l+c.y+"px",d.left=g+c.x+"px"}function J({x:f,y:c,nodeKey:d,color:u,caption:g}){const[l]=_(),a=y.exports.useRef(null),p=y.exports.useRef({isDragging:!1,offsetX:0,offsetY:0,rootElementRect:null,x:0,y:0}),{isCollabActive:b}=z();y.exports.useEffect(()=>{const e=p.current;e.x=f,e.y=c;const o=a.current;o!==null&&m(o,e)},[f,c]),D(()=>{const e=p.current,o=new ResizeObserver(r=>{for(let i=0;i<r.length;i++){const N=r[i],{target:S}=N;e.rootElementRect=S.getBoundingClientRect();const v=a.current;v!==null&&m(v,e)}}),t=l.registerRootListener((r,i)=>{i!==null&&o.unobserve(i),r!==null&&o.observe(r)}),n=()=>{const r=l.getRootElement(),i=a.current;r!==null&&i!==null&&(e.rootElementRect=r.getBoundingClientRect(),m(i,e))};return window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n),t()}},[l]),y.exports.useEffect(()=>{const e=a.current;e!==null&&setTimeout(()=>{e.style.setProperty("transition","top 0.3s ease 0s, left 0.3s ease 0s")},500)},[]);const x=e=>{const o=a.current,t=p.current,n=t.rootElementRect;o!==null&&t.isDragging&&n!==null&&(t.x=e.pageX-t.offsetX-n.left,t.y=e.pageY-t.offsetY-n.top,m(o,t))},C=e=>{const o=a.current,t=p.current;o!==null&&(t.isDragging=!1,o.classList.remove("dragging"),l.update(()=>{const n=h(d);k(n)&&n.setPosition(t.x,t.y)})),document.removeEventListener("pointermove",x),document.removeEventListener("pointerup",C)},w=()=>{l.update(()=>{const e=h(d);k(e)&&e.remove()})},L=()=>{l.update(()=>{const e=h(d);k(e)&&e.toggleColor()})},{historyState:R}=T();return s("div",{ref:a,className:"sticky-note-container",children:E("div",{className:`sticky-note ${u}`,onPointerDown:e=>{const o=a.current;if(o==null||e.button===2||e.target!==o.firstChild)return;const t=o,n=p.current;if(t!==null){const{top:r,left:i}=t.getBoundingClientRect();n.offsetX=e.clientX-i,n.offsetY=e.clientY-r,n.isDragging=!0,t.classList.add("dragging"),document.addEventListener("pointermove",x),document.addEventListener("pointerup",C),e.preventDefault()}},children:[s("button",{onClick:w,className:"delete","aria-label":"Delete sticky note",title:"Delete",children:"X"}),s("button",{onClick:L,className:"color","aria-label":"Change sticky note color",title:"Color",children:s("i",{className:"bucket"})}),E(I,{initialEditor:g,initialTheme:A,children:[b?s(B,{id:g.getKey(),providerFactory:X,shouldBootstrap:!0}):s($,{externalHistoryState:R}),s(Y,{contentEditable:s(j,{className:"StickyNode__contentEditable"}),placeholder:s(H,{className:"StickyNode__placeholder",children:"What's up?"}),ErrorBoundary:W})]})]})})}export{J as default};
