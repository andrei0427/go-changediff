import{a2 as e,r as t,a3 as n,u as o,o as r,t as s,a as l,j as a,y as i,z as c,G as u,a4 as d,I as p,P as f,J as g,$ as m,a5 as y}from"./main.00ecd330.js";import{L as v}from"./LexicalNestedComposer.90c8ce6e.js";const E=e?t.exports.useLayoutEffect:t.exports.useEffect;var h={...n,paragraph:"StickyEditorTheme__paragraph"};function x(e,t){const n=e.style,o=t.rootElementRect,r=null!==o?o.left:0,s=null!==o?o.top:0;n.top=s+t.y+"px",n.left=r+t.x+"px"}function R({x:e,y:n,nodeKey:R,color:b,caption:L}){const[C]=o(),k=t.exports.useRef(null),N=t.exports.useRef({isDragging:!1,offsetX:0,offsetY:0,rootElementRect:null,x:0,y:0}),{isCollabActive:D}=r();t.exports.useEffect((()=>{const t=N.current;t.x=e,t.y=n;const o=k.current;null!==o&&x(o,t)}),[e,n]),E((()=>{const e=N.current,t=new ResizeObserver((t=>{for(let n=0;n<t.length;n++){const o=t[n],{target:r}=o;e.rootElementRect=r.getBoundingClientRect();const s=k.current;null!==s&&x(s,e)}})),n=C.registerRootListener(((e,n)=>{null!==n&&t.unobserve(n),null!==e&&t.observe(e)})),o=()=>{const t=C.getRootElement(),n=k.current;null!==t&&null!==n&&(e.rootElementRect=t.getBoundingClientRect(),x(n,e))};return window.addEventListener("resize",o),()=>{window.removeEventListener("resize",o),n()}}),[C]),t.exports.useEffect((()=>{const e=k.current;null!==e&&setTimeout((()=>{e.style.setProperty("transition","top 0.3s ease 0s, left 0.3s ease 0s")}),500)}),[]);const w=e=>{const t=k.current,n=N.current,o=n.rootElementRect;null!==t&&n.isDragging&&null!==o&&(n.x=e.pageX-n.offsetX-o.left,n.y=e.pageY-n.offsetY-o.top,x(t,n))},X=e=>{const t=k.current,n=N.current;null!==t&&(n.isDragging=!1,t.classList.remove("dragging"),C.update((()=>{const e=m(R);y(e)&&e.setPosition(n.x,n.y)}))),document.removeEventListener("pointermove",w),document.removeEventListener("pointerup",X)},{historyState:_}=s();return l("div",{ref:k,className:"sticky-note-container",children:a("div",{className:`sticky-note ${b}`,onPointerDown:e=>{const t=k.current;if(null==t||2===e.button||e.target!==t.firstChild)return;const n=t,o=N.current;if(null!==n){const{top:t,left:r}=n.getBoundingClientRect();o.offsetX=e.clientX-r,o.offsetY=e.clientY-t,o.isDragging=!0,n.classList.add("dragging"),document.addEventListener("pointermove",w),document.addEventListener("pointerup",X),e.preventDefault()}},children:[l("button",{onClick:()=>{C.update((()=>{const e=m(R);y(e)&&e.remove()}))},className:"delete","aria-label":"Delete sticky note",title:"Delete",children:"X"}),l("button",{onClick:()=>{C.update((()=>{const e=m(R);y(e)&&e.toggleColor()}))},className:"color","aria-label":"Change sticky note color",title:"Color",children:l("i",{className:"bucket"})}),a(v,{initialEditor:L,initialTheme:h,children:[D?l(i,{id:L.getKey(),providerFactory:c,shouldBootstrap:!0}):l(u,{externalHistoryState:_}),l(d,{contentEditable:l(p,{className:"StickyNode__contentEditable"}),placeholder:l(f,{className:"StickyNode__placeholder",children:"What's up?"}),ErrorBoundary:g})]})]})})}export{R as default};
